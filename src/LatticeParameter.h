#ifndef LATTICEPARAMETER_H_
#define LATTICEPARAMETER_H_

// Global parameters for D2Q9 discretization
// TODO: 考虑MPI中全局变量的值，是否需要广播

/* Velocity set */
const double cx[9] = { 0.,1.,0.,-1.,0.,1.,-1.,-1.,1. };
const double cy[9] = { 0.,0.,1.,0.,-1.,1.,1.,-1.,-1. };
const double w[9] = {
	4. / 9.,
	1. / 9., 1. / 9., 1. / 9., 1. / 9.,
	1. / 36., 1. / 36., 1. / 36., 1. / 36.
};

/* Collision operator */
// SRT
double tau = 0.8, omega = 1.0 / tau, omegac = 1.0 - omega;

// MRT (with Gram-Schmidt orthogonal moment)
// TODO: 检查是否有误
double omega1, omega2, omega3, omega4;
const double M[9][9] = {
	{	1,	1,	1,	1,	1,	1,	1,	1,	1	},
	{	-4,	-1,	-1,	-1,	-1,	2,	2,	2,	2	},
	{	4,	-2,	-2,	-2,	-2,	1,	1,	1,	1	},
	{	0,	1,	0,	-1,	0,	1,	-1,	-1,	1	},
	{	0,	-2,	0,	2,	0,	1,	-1,	-1,	1	},
	{	0,	0,	1,	0,	-1,	1,	1,	-1,	-1	},
	{	0,	0,	-2,	0,	2,	1,	1,	-1,	-1	},
	{	0,	1,	-1,	1,	-1,	0,	0,	0,	0	},
	{	0,	0,	0,	0,	0,	1,	-1,	1,	-1	},
};
const double Minv[9][9] = {
	{	1. / 9,	-1. / 9,	1. / 9,		0,			0,			0,			0,			0,			0		},
	{	1. / 9,	-1. / 36,	-1. / 18,	1. / 6,		-1. / 6,	0,			0,			1. / 4,		0		},
	{	1. / 9,	-1. / 36,	-1. / 18,	0,			0,			1. / 6,		-1. / 6,	-1. / 4,	0		},
	{	1. / 9,	-1. / 36,	-1. / 18,	-1. / 6,	1. / 6,		0,			0,			1. / 4,		0		},
	{	1. / 9,	-1. / 36,	-1. / 18,	0,			0,			-1. / 6,	1. / 6,		-1. / 4,	0		},
	{	1. / 9,	1. / 18,	1. / 36,	1. / 6,		1. / 12,	1. / 6,		1. / 12,	0,			1. / 4	},
	{	1. / 9,	1. / 18,	1. / 36,	-1. / 6,	-1. / 12,	1. / 6,		1. / 12,	0,			-1. / 4	},
	{	1. / 9,	1. / 18,	1. / 36,	-1. / 6,	-1. / 12,	-1. / 6,	-1. / 12,	0,			1. / 4	},
	{	1. / 9,	1. / 18,	1. / 36,	1. / 6,		1. / 12,	-1. / 6,	-1. / 12,	0,			-1. / 4	},
};

#endif // !LATTICEPARAMETER_H_